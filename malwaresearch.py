#!/usr/bin/python

import urllib2, sys
from bs4 import BeautifulSoup
import time

t1 = time.time()

host = 'http://openmalware.org'
address = '/search.cgi?search=' 
malfind = sys.argv[1]
site = host+address+malfind

def download(url):
    print('Starting malwaresearch ...\n')
    try:
        html = urllib2.urlopen(url).read()
    except urllib2.URLError as e:
        print 'Sorry, download error:', e.reason
        html = None
    return html

url = download(site)
soup = BeautifulSoup(url,'lxml')

#print numbers of found
founds = soup.find('h3').string
print('\33[1;31m\n\t\t' + founds + '\n\033[0m')
print('This is the first result!')

tr2 = soup(attrs={'id':'checksum'})[4]
area2 = tr2.text
print('Original Filename '+ area2)

for i in range(0,4):
    try:
        tr = soup(attrs={'id':'checksum'})[i]
        area = tr.text
        if (i==0):
            print('MD5 %s' % area)
        elif (i==1):
            print('SHA1: %s' % area)
        elif (i==2):
            print('SHA256: %s' % area)
            sys.exit(0)
    except:
        break

t2 = time.time()
total_time = t2-t1
print('Time total %.2f seconds' %total_time)
