#!/usr/bin/python
# -*- coding: UTF-8 -*-

import urllib2, sys
from bs4 import BeautifulSoup
import time

t1 = time.time()

host = 'http://openmalware.org'
address = '/search.cgi?search=' 
malfind = sys.argv[1]
site = host+address+malfind

def download(url):
    print('Starting malwaresearch ...')
    try:
        html = urllib2.urlopen(url).read()
    except urllib2.URLError as e:
        print ('Sorry, download error:', e.reason)
        html = None
    return html

url = download(site)
soup = BeautifulSoup(url,'lxml')

#print numbers of found
founds = soup.find('h3').string
print('\033[1;31m\n\t\t' + founds + '\n\033[0m')
print('This is the first result!\n')

for i in range(0,6):
    try:
        tr = soup(attrs={'id':'checksum'})[i]
        area = tr.text.strip('\n')
        has1 = soup('b')[i].string
        if (has1 == 'Original Filename:'):
            print('\033[1;32m' + has1+ '\t' + area + '\033[0m')
        else:
            print(has1 + '\t\t\t' + area)
    except:
        break
    

t2 = time.time()
total_time = t2-t1
print('\n\nTime total %.2f seconds' %total_time)
